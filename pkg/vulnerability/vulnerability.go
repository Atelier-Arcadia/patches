package vulnerability

import (
	"github.com/zsck/patches/pkg/done"
	"github.com/zsck/patches/pkg/pack"
)

// Source describes types that can serve a stream of information about
// vulnerabilities affecting software packages.
type Source interface {
	Vulnerabilities() (<-chan Vulnerability, <-chan done.Done, error)
}

// Vulnerability describes a vulnerability affecting a package
type Vulnerability struct {
	Name                 string         `json:"name"`
	AffectedPackageName  string         `json:"affectedPackedName"`
	AffectedPlatformName string         `json:"affectedPlatform"`
	DetailsHref          string         `json:"detailsHref"`
	SeverityRating       Severity       `json:"severityRating"`
	FixedInPackages      []pack.Package `json:"fixedInPackages"`
}

// Severity enumerates the levels of severity that a vulnerability can be
// rated with.
type Severity uint8

const (
	SeverityUnknown    Severity = iota
	SeverityNegligible Severity = iota
	SeverityLow        Severity = iota
	SeverityMedium     Severity = iota
	SeverityHigh       Severity = iota
	SeverityCritical   Severity = iota
	SeverityUrgent     Severity = iota
)
