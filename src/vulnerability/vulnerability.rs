use semver::SemVerError;

use package::Package;


/// Indicates how severe a vulnerability is.
#[derive(Debug, Clone, Copy, Serialize, Deserialize)]
pub enum Severity {
  #[serde(rename = "unknown")]
  Unknown,
  #[serde(rename = "negligable")]
  Negligable,
  #[serde(rename = "low")]
  Low,
  #[serde(rename = "medium")]
  Medium,
  #[serde(rename = "high")]
  High,
  #[serde(rename = "critical")]
  Critical,
  #[serde(rename = "urgent")]
  Urgent,
}

/// Describes a vulnerability, the package it affects, and any package versions
/// in which the vulnerability was fixed.
#[derive(Clone, Debug)]
pub struct Vulnerability {
  pub name: String,
  pub package: String,
  pub href: String,
  pub severity: Severity,
  pub fixes: Vec<Package>,
}
